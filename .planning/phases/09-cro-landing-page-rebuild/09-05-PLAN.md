# Plan 09-05: Exit Intent + Enterprise Section

<objective>
Add exit intent popup for email capture and enterprise section with Calendly booking. These capture leads who aren't ready to purchase immediately.
</objective>

<execution_context>
@.planning/phases/09-cro-landing-page-rebuild/SPEC.md (Sections 6, 9: Exit Intent, Enterprise)
@src/routes/+page.svelte
</execution_context>

<context>
**Current State:**
- No exit intent popup
- No enterprise section
- No email capture mechanism
- No Calendly integration

**SPEC Requirements:**
- Exit Intent: Popup when cursor moves toward browser chrome
- Lead magnet: "Documentation That Doesn't Suck" checklist
- Enterprise: Bulk pricing, custom templates, SSO mention
- Calendly: "Book a Demo Call" CTA

**Lead Capture Strategy:** Capture emails for nurture sequence
</context>

<tasks>

## Task 1: Create ExitIntent Component

Build exit intent popup with email capture.

**Requirements:**
- Trigger: Mouse moves toward top of viewport (desktop)
- One popup per session (localStorage)
- Lead magnet: "Documentation That Doesn't Suck" checklist
- Email input + submit button
- Close button (X)
- Microcopy: "No spam. Unsubscribe anytime."

**SPEC Layout:**
```
┌────────────────────────────────────┐
│                              [X]   │
│    Wait — before you go...         │
│                                    │
│    Get our "Documentation          │
│    That Doesn't Suck" checklist    │
│                                    │
│    ┌────────────────────────────┐  │
│    │ your@email.com             │  │
│    └────────────────────────────┘  │
│    [ Send Me The Checklist ]       │
│                                    │
│    No spam. Unsubscribe anytime.   │
└────────────────────────────────────┘
```

**File:** `src/lib/components/ExitIntent.svelte`

**Acceptance:**
- [ ] Popup triggers on exit intent
- [ ] Once per session (localStorage)
- [ ] Email validation
- [ ] Close button works
- [ ] Track analytics on show/submit

---

## Task 2: Create EnterpriseSection Component

Build enterprise/team section with Calendly CTA.

**Requirements:**
- Header: "Need docs for your whole team?"
- Bullet points: Bulk pricing, custom templates, SSO
- CTA: "Book a Demo Call" linking to Calendly
- Subtle background differentiation

**SPEC Copy:**
```
• Bulk pricing for 10+ repos
• Custom templates matching your style guide
• SSO & team management
```

**File:** `src/lib/components/EnterpriseSection.svelte`

**Acceptance:**
- [ ] Section displays benefits
- [ ] Calendly link works (can be placeholder)
- [ ] Visually distinct from other sections
- [ ] Mobile responsive

---

## Task 3: Email Storage API

Create simple API endpoint to store captured emails.

**Requirements:**
- POST /api/leads endpoint
- Store: email, source (exit_intent, etc.), timestamp
- Validate email format
- Prevent duplicates
- Return success/error response

**Database:**
- Add `leads` table or use existing mechanism
- Fields: id, email, source, created_at

**File:** `src/routes/api/leads/+server.ts`

**Acceptance:**
- [ ] Endpoint accepts POST with email
- [ ] Stores to database
- [ ] Validates email format
- [ ] Returns appropriate status codes
- [ ] Rate limited (prevent spam)

</tasks>

<verification>
```bash
npm run dev
# Test exit intent:
# 1. Move cursor toward top of browser
# 2. Popup should appear
# 3. Enter email and submit
# 4. Check database for lead

# Test enterprise section:
# 1. Scroll to enterprise section
# 2. Click "Book a Demo Call"
# 3. Verify link works
```
</verification>

<success_criteria>
- [ ] ExitIntent component created and triggers
- [ ] EnterpriseSection component created
- [ ] /api/leads endpoint works
- [ ] Email validation in place
- [ ] Analytics tracked
- [ ] Mobile: Exit intent disabled (no mouse)
- [ ] No TypeScript errors
</success_criteria>

<output>
New files:
- `src/lib/components/ExitIntent.svelte`
- `src/lib/components/EnterpriseSection.svelte`
- `src/routes/api/leads/+server.ts`

Updated files:
- `src/routes/+page.svelte` - Added enterprise section and exit intent

Database:
- May need leads table migration

Ready for: Plan 09-06 (Analytics + Mobile)
</output>
